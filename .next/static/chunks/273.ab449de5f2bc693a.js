"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[273],{38273:(e,a,t)=>{t.d(a,{PDFSplitter:()=>r});var n=t(13366);class r{static async splitPDF(e,a){let t=await e.arrayBuffer(),r=await n.PDFDocument.load(t),i=r.getPageCount(),s=e.name.replace(".pdf","");switch(a.mode){case"single":return this.splitIntoSinglePages(r,s,i);case"pages":return this.splitByPagesPerFile(r,s,i,a.pagesPerFile||1);case"range":return this.splitByRanges(r,s,a.ranges||"");default:throw Error("잘못된 분할 모드입니다.")}}static async splitIntoSinglePages(e,a,t){let r=[];for(let i=0;i<t;i++){let t=await n.PDFDocument.create(),[s]=await t.copyPages(e,[i]);t.addPage(s);let c=new Blob([new Uint8Array(await t.save())],{type:"application/pdf"});r.push({fileName:"".concat(a,"_page").concat(i+1,".pdf"),blob:c,pageInfo:"".concat(i+1)})}return r}static async splitByPagesPerFile(e,a,t,r){let i=[],s=1;for(let c=0;c<t;c+=r){let l=Math.min(c+r-1,t-1),o=Array.from({length:l-c+1},(e,a)=>c+a),p=await n.PDFDocument.create();for(let a of(await p.copyPages(e,o)))p.addPage(a);let g=new Blob([new Uint8Array(await p.save())],{type:"application/pdf"});i.push({fileName:"".concat(a,"_part").concat(s,".pdf"),blob:g,pageInfo:"".concat(c+1,"-").concat(l+1)}),s++}return i}static async splitByRanges(e,a,t){let r=[],i=t.split(",").map(e=>e.trim());for(let t=0;t<i.length;t++){let s=i[t],c=this.parsePageRange(s);if(0===c.length)continue;let l=await n.PDFDocument.create();for(let a of(await l.copyPages(e,c)))l.addPage(a);let o=new Blob([new Uint8Array(await l.save())],{type:"application/pdf"});r.push({fileName:"".concat(a,"_range").concat(t+1,".pdf"),blob:o,pageInfo:s})}return r}static parsePageRange(e){let a=[];if(e.includes("-")){let[t,n]=e.split("-").map(e=>parseInt(e.trim())-1);if(!isNaN(t)&&!isNaN(n)&&t<=n)for(let e=t;e<=n;e++)a.push(e)}else{let t=parseInt(e.trim())-1;isNaN(t)||a.push(t)}return a}static async getPDFInfo(e){try{let a=await e.arrayBuffer(),t=(await n.PDFDocument.load(a)).getPageCount(),r="".concat((e.size/1024/1024).toFixed(2)," MB");return{pageCount:t,size:r}}catch(e){throw Error("PDF 파일 정보를 가져올 수 없습니다.")}}}}}]);