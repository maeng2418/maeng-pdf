"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[406],{60406:(e,t,a)=>{a.d(t,{PDFConverter:()=>i});var r=a(18460);class i{static async imagesToPDF(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{quality:a=80,pageSize:r="a4",orientation:i="portrait",mergeIntoOne:o=!0}=t;return o?this.createSinglePDFFromImages(e,{quality:a,pageSize:r,orientation:i}):this.createMultiplePDFsFromImages(e,{quality:a,pageSize:r,orientation:i})}static async createSinglePDFFromImages(e,t){let{pageSize:a="a4",orientation:i="portrait",quality:o=80}=t,l=new r.Ay({orientation:i,unit:"mm",format:a}),n=!0;for(let t of e){let e,a,r=await this.fileToDataURL(t);n||l.addPage();let i=l.internal.pageSize.getWidth(),o=l.internal.pageSize.getHeight(),s=new Image;await new Promise((e,t)=>{s.onload=e,s.onerror=t,s.src=r});let c=s.width/s.height;c>i/o?a=(e=i-20)/c:e=(a=o-20)*c;let p=(i-e)/2,d=(o-a)/2;l.addImage(r,"JPEG",p,d,e,a),n=!1}return new Blob([l.output("blob")],{type:"application/pdf"})}static async createMultiplePDFsFromImages(e,t){let r=new(await a.e(987).then(a.t.bind(a,53987,23))).default;for(let a=0;a<e.length;a++){let i=e[a],o=await this.createSinglePDFFromImages([i],t),l="".concat(i.name.split(".")[0],".pdf");r.file(l,o)}return await r.generateAsync({type:"blob"})}static fileToDataURL(e){return new Promise((t,a)=>{let r=new FileReader;r.onload=e=>{var a;return t(null==(a=e.target)?void 0:a.result)},r.onerror=a,r.readAsDataURL(e)})}static async wordToPDF(e){try{let t=await Promise.all([a.e(987),a.e(183)]).then(a.t.bind(a,76183,19)),i=await e.arrayBuffer(),o=await t.convertToHtml({arrayBuffer:i}),l=new r.Ay,n=o.value.split("\n"),s=20;for(let e of n){let t=e.replace(/<[^>]*>/g,"");t.trim()&&(l.text(t,20,s),(s+=10)>280&&(l.addPage(),s=20))}return new Blob([l.output("blob")],{type:"application/pdf"})}catch(e){throw Error("Word 변환 중 오류가 발생했습니다: ".concat(e))}}static async excelToPDF(e){try{let t=await Promise.all([a.e(430),a.e(914)]).then(a.bind(a,8629)),i=await e.arrayBuffer(),o=t.read(i),l=new r.Ay,n=!0;for(let e of o.SheetNames){n||l.addPage();let a=o.Sheets[e],r=t.utils.sheet_to_csv(a).split("\n");l.setFontSize(14),l.text(e,20,20);let i=35;for(let e of r){let t=e.split(","),a=20;for(let e of t)e.trim()&&(l.setFontSize(10),l.text(e,a,i),a+=40);(i+=8)>280&&(l.addPage(),i=20)}n=!1}return new Blob([l.output("blob")],{type:"application/pdf"})}catch(e){throw Error("Excel 변환 중 오류가 발생했습니다: ".concat(e))}}static getFileExtension(e){var t;return(null==(t=e.split(".").pop())?void 0:t.toLowerCase())||""}static isImageFile(e){return["jpg","jpeg","png","bmp","tiff","gif"].includes(this.getFileExtension(e.name))||e.type.startsWith("image/")}static isWordFile(e){return["doc","docx"].includes(this.getFileExtension(e.name))||"application/vnd.openxmlformats-officedocument.wordprocessingml.document"===e.type}static isExcelFile(e){return["xls","xlsx"].includes(this.getFileExtension(e.name))||"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"===e.type}}}}]);